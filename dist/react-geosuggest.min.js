var Geosuggest=function(u){"use strict";var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])})(t,e)};function t(t,e){function s(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}var c=function(){return(c=Object.assign||function(t){for(var e,s=1,o=arguments.length;s<o;s++)for(var i in e=arguments[s])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function v(){return S.Date.now()}var s,n=(function(t){function r(){for(var t=[],e=0;e<arguments.length;e++){var s=arguments[e];if(s){var o=typeof s;if("string"==o||"number"==o)t.push(s);else if(Array.isArray(s)&&s.length){var i=r.apply(null,s);i&&t.push(i)}else if("object"==o)for(var n in s)u.call(s,n)&&s[n]&&t.push(n)}}return t.join(" ")}var u;u={}.hasOwnProperty,t.exports?(r.default=r,t.exports=r):window.classNames=r}(s={exports:{}}),s.exports),r=NaN,p="[object Symbol]",a=/^\s+|\s+$/g,g=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,h=/^0o[0-7]+$/i,d=parseInt,i="object"==typeof e&&e&&e.Object===Object&&e,f="object"==typeof self&&self&&self.Object===Object&&self,S=i||f||Function("return this")(),m=Object.prototype.toString,y=Math.max,b=Math.min;function I(t){var e=typeof t;return t&&("object"==e||"function"==e)}function w(t){if("number"==typeof t)return t;if("symbol"==typeof(e=t)||(s=e)&&"object"==typeof s&&m.call(e)==p)return r;var e,s,o;if(I(t)&&(t=I(o="function"==typeof t.valueOf?t.valueOf():t)?o+"":o),"string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var i=l.test(t);return i||h.test(t)?d(t.slice(2),i?2:8):g.test(t)?r:+t}var C=function(o,i,t){var n,r,u,p,a,g,l=0,c=!1,h=!1,e=!0;if("function"!=typeof o)throw new TypeError("Expected a function");function d(t){var e=n,s=r;return n=r=void 0,l=t,p=o.apply(s,e)}function f(t){var e=t-g;return void 0===g||i<=e||e<0||h&&u<=t-l}function S(){var t,e,s=v();if(f(s))return m(s);a=setTimeout(S,(e=i-((t=s)-g),h?b(e,u-(t-l)):e))}function m(t){return a=void 0,e&&n?d(t):(n=r=void 0,p)}function s(){var t,e=v(),s=f(e);if(n=arguments,r=this,g=e,s){if(void 0===a)return l=t=g,a=setTimeout(S,i),c?d(t):p;if(h)return a=setTimeout(S,i),d(g)}return void 0===a&&(a=setTimeout(S,i)),p}return i=w(i)||0,I(t)&&(c=!!t.leading,h="maxWait"in t,u=h?y(w(t.maxWait)||0,i):u,e="trailing"in t?!!t.trailing:e),s.cancel=function(){void 0!==a&&clearTimeout(a),n=g=r=a=void(l=0)},s.flush=function(){return void 0===a?p:m(v())},s},N={autoActivateFirstSuggest:!1,disabled:!1,fixtures:[],getSuggestLabel:function(t){return t.description},highlightMatch:!0,ignoreEnter:!1,ignoreTab:!1,initialValue:"",maxFixtures:10,minLength:1,onKeyDown:function(){},onKeyPress:function(){},placeholder:"Search places",queryDelay:250,skipSuggest:function(){return!1},style:{}},x=["autoCapitalize","autoComplete","autoCorrect","autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","height","inputMode","maxLength","name","onClick","onContextMenu","onCopy","onCut","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPaste","pattern","placeholder","readOnly","required","size","spellCheck","tabIndex","title","aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-dropeffect","aria-errormessage","aria-flowto","aria-grabbed","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription","aria-activedescendant","aria-autocomplete","aria-multiline","aria-placeholder","aria-readonly","aria-required"];function M(s){var o={};return Object.keys(s).forEach(function(t){var e=t.startsWith("data-");(x.includes(t)||e)&&(o[t]=s[t])}),o}var D,T=(t(O,D=u.PureComponent),O.prototype.onChange=function(){this.input&&this.props.onChange(this.input.value)},O.prototype.onInputKeyDown=function(t){switch(this.props.onKeyDown&&this.props.onKeyDown(t),t.which){case 40:t.shiftKey||(t.preventDefault(),this.props.onNext());break;case 38:t.shiftKey||(t.preventDefault(),this.props.onPrev());break;case 13:this.props.doNotSubmitOnEnter&&t.preventDefault(),this.props.ignoreEnter||this.props.onSelect();break;case 9:this.props.ignoreTab||this.props.onSelect();break;case 27:this.props.onEscape()}},O.prototype.focus=function(){this.input&&this.input.focus()},O.prototype.blur=function(){this.input&&this.input.blur()},O.prototype.render=function(){var e=this,t=M(this.props),s=n("geosuggest__input",this.props.className),o=this.props.label&&this.props.id;return t.tabIndex||(t.tabIndex=0),u.createElement(u.Fragment,null,o&&u.createElement("label",{className:"geosuggest__label",htmlFor:this.props.id},this.props.label),u.createElement("input",c({className:s,id:"geosuggest__input"+(this.props.id?"--"+this.props.id:""),ref:function(t){return e.input=t},type:"search"},t,{value:this.props.value,style:this.props.style,onKeyDown:this.onInputKeyDown,onChange:this.onChange,onKeyPress:this.props.onKeyPress,onFocus:this.props.onFocus,onBlur:this.props.onBlur,role:"combobox","aria-expanded":!this.props.isSuggestsHidden,"aria-activedescendant":this.props.activeSuggest?this.props.activeSuggest.placeId:void 0,"aria-owns":this.props.listId})))},O.defaultProps={activeSuggest:null,autoComplete:"nope",className:"",isSuggestsHidden:!0,listId:"",onBlur:function(){},onChange:function(){},onEscape:function(){},onFocus:function(){},onKeyDown:function(){},onKeyPress:function(){},onNext:function(){},onPrev:function(){},onSelect:function(){},value:""},O);function O(t){var e=D.call(this,t)||this;return e.input=null,e.onChange=e.onChange.bind(e),e.onInputKeyDown=e.onInputKeyDown.bind(e),e}var _,E=(t(A,_=u.PureComponent),A.prototype.makeBold=function(t,e){return u.createElement("b",{className:"geosuggest__item__matched-text",key:e},t)},A.prototype.formatMatchedText=function(t,e){if(!t||!e.matchedSubstrings)return e.label;var s=e.matchedSubstrings.offset,o=s+e.matchedSubstrings.length,i=this.makeBold(e.label.substring(s,o),e.label),n="",r="";return 0<s&&(n=e.label.slice(0,s)),o<e.label.length&&(r=e.label.slice(o)),u.createElement("span",null,n,i,r)},A.prototype.componentDidUpdate=function(t){!t.isActive&&this.props.isActive&&this.scrollIfNeeded()},A.prototype.scrollIfNeeded=function(){var t,e,s=this.ref,o=s&&s.parentElement;s&&o&&(t=s.offsetTop-o.offsetTop<o.scrollTop,e=s.offsetTop-o.offsetTop+s.clientHeight>o.scrollTop+o.clientHeight,(t||e)&&(o.scrollTop=s.offsetTop-o.offsetTop-o.clientHeight/2+s.clientHeight/2))},A.prototype.onClick=function(t){t.preventDefault(),this.props.onSelect(this.props.suggest)},A.prototype.render=function(){var t,e=this,s=this.props.suggest,o=n("geosuggest__item",this.props.className,this.props.suggestItemClassName,{"geosuggest__item--active":this.props.isActive},((t={})[this.props.activeClassName||""]=this.props.activeClassName?this.props.isActive:null,t)),i=s.label;return this.props.renderSuggestItem?i=this.props.renderSuggestItem(s,this.props.userInput):this.props.isHighlightMatch&&(i=this.formatMatchedText(this.props.userInput,s)),u.createElement("li",{className:o,ref:function(t){return e.ref=t},style:this.props.style,onMouseDown:this.props.onMouseDown,onMouseOut:this.props.onMouseOut,onClick:this.onClick,role:"option","aria-selected":this.props.isActive,id:s.placeId},i)},A);function A(t){var e=_.call(this,t)||this;return e.ref=null,e.onClick=e.onClick.bind(e),e}var k,P,F=(t(H,k=u.PureComponent),H.prototype.isHidden=function(){return this.props.isHidden||0===this.props.suggests.length},H.prototype.componentDidUpdate=function(t){t.suggests!==this.props.suggests&&0===this.props.suggests.length&&this.props.onSuggestNoResults()},H.prototype.render=function(){var t,s=this,e=n("geosuggest__suggests",this.props.suggestsClassName,{"geosuggest__suggests--hidden":this.isHidden()},((t={})[this.props.hiddenClassName||""]=this.props.hiddenClassName?this.isHidden():null,t));return u.createElement("ul",{className:e,style:this.props.style,role:"listbox",id:this.props.listId},this.props.suggests.map(function(t){var e=s.props.activeSuggest&&t.placeId===s.props.activeSuggest.placeId||!1;return u.createElement(E,{key:t.placeId,className:t.className||"",userInput:s.props.userInput,isHighlightMatch:s.props.isHighlightMatch,suggest:t,style:s.props.suggestItemStyle,suggestItemClassName:s.props.suggestItemClassName,isActive:e,activeClassName:s.props.suggestItemActiveClassName,onMouseDown:s.props.onSuggestMouseDown,onMouseOut:s.props.onSuggestMouseOut,onSelect:s.props.onSuggestSelect,renderSuggestItem:s.props.renderSuggestItem})}))},H);function H(){return null!==k&&k.apply(this,arguments)||this}function K(t){var e=P.call(this,t)||this;return e.googleMaps=null,e.autocompleteService=null,e.placesService=null,e.sessionToken=void 0,e.geocoder=null,e.input=null,e.state={activeSuggest:null,ignoreBlur:!1,isLoading:!1,isSuggestsHidden:!0,suggests:[],userInput:t.initialValue||""},e.onInputChange=e.onInputChange.bind(e),e.onAfterInputChange=e.onAfterInputChange.bind(e),e.onInputFocus=e.onInputFocus.bind(e),e.onInputBlur=e.onInputBlur.bind(e),e.onNext=e.onNext.bind(e),e.onPrev=e.onPrev.bind(e),e.onSelect=e.onSelect.bind(e),e.onSuggestMouseDown=e.onSuggestMouseDown.bind(e),e.onSuggestMouseOut=e.onSuggestMouseOut.bind(e),e.onSuggestNoResults=e.onSuggestNoResults.bind(e),e.hideSuggests=e.hideSuggests.bind(e),e.selectSuggest=e.selectSuggest.bind(e),e.listId="geosuggest__list"+(t.id?"--"+t.id:""),t.queryDelay&&(e.onAfterInputChange=C(e.onAfterInputChange,t.queryDelay)),e}return t(K,P=u.Component),K.prototype.componentDidUpdate=function(t){t.initialValue!==this.props.initialValue&&this.setState({userInput:this.props.initialValue||""}),JSON.stringify(t.fixtures)!==JSON.stringify(this.props.fixtures)&&this.searchSuggests()},K.prototype.componentDidMount=function(){var t;"undefined"!=typeof window&&((t=this.props.googleMaps||window.google&&window.google.maps||this.googleMaps)?(this.googleMaps=t,this.autocompleteService=new t.places.AutocompleteService,this.placesService=new t.places.PlacesService(document.createElement("div")),this.sessionToken=new t.places.AutocompleteSessionToken,this.geocoder=new t.Geocoder):console&&console.error("Google maps API was not found in the page."))},K.prototype.componentWillUnmount=function(){clearTimeout(this.timer)},K.prototype.onInputChange=function(t){t||this.props.onSuggestSelect&&this.props.onSuggestSelect(),this.setState({userInput:t},this.onAfterInputChange)},K.prototype.onAfterInputChange=function(){this.showSuggests(),this.props.onChange&&this.props.onChange(this.state.userInput)},K.prototype.onInputFocus=function(){this.props.onFocus&&this.props.onFocus(),this.showSuggests()},K.prototype.onInputBlur=function(){this.state.ignoreBlur||this.hideSuggests()},K.prototype.onNext=function(){this.activateSuggest("next")},K.prototype.onPrev=function(){this.activateSuggest("prev")},K.prototype.onSelect=function(){this.selectSuggest(this.state.activeSuggest)},K.prototype.onSuggestMouseDown=function(){this.setState({ignoreBlur:!0})},K.prototype.onSuggestMouseOut=function(){this.setState({ignoreBlur:!1})},K.prototype.onSuggestNoResults=function(){this.props.onSuggestNoResults&&this.props.onSuggestNoResults(this.state.userInput)},K.prototype.focus=function(){this.input&&this.input.focus()},K.prototype.blur=function(){this.input&&this.input.blur()},K.prototype.update=function(t){this.setState({userInput:t}),this.props.onChange&&this.props.onChange(t)},K.prototype.clear=function(){this.setState({userInput:""},this.hideSuggests)},K.prototype.searchSuggests=function(){var t,e,s,o,i,n,r,u,p=this;this.state.userInput?(t={input:this.state.userInput,sessionToken:this.sessionToken},e=this.state.userInput.length,this.props.minLength&&e<this.props.minLength?this.updateSuggests():(o=(s=this.props).location,i=s.radius,n=s.bounds,r=s.types,u=s.country,o&&(t.location=o),i&&(t.radius=Number(this.props.radius)),n&&(t.bounds=n),r&&(t.types=r),u&&(t.componentRestrictions={country:u}),this.setState({isLoading:!0},function(){p.autocompleteService?p.autocompleteService.getPlacePredictions(t,function(t){p.setState({isLoading:!1}),p.updateSuggests(t||[],function(){p.props.autoActivateFirstSuggest&&!p.state.activeSuggest&&p.activateSuggest("next")})}):p.setState({isLoading:!1})}))):this.updateSuggests()},K.prototype.updateSuggests=function(t,e){var s=this;void 0===t&&(t=[]),void 0===e&&(e=function(){});var o,i=[],n=this.state.userInput,r=this.props,u=r.skipSuggest,p=r.maxFixtures,a=r.fixtures,g=new RegExp(n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"gim"),l=0;a&&a.forEach(function(t){p&&p<=l||u&&!u(t)&&t.label.match(g)&&(l++,i.push(c(c({},t),{isFixture:!0,matchedSubstrings:{length:n.length,offset:t.label.indexOf(n)},placeId:t.placeId||t.label})))}),t.forEach(function(t){u&&!u(t)&&i.push({description:t.description,isFixture:!1,label:s.props.getSuggestLabel?s.props.getSuggestLabel(t):"",matchedSubstrings:t.matched_substrings[0],placeId:t.place_id})}),o=this.updateActiveSuggest(i),this.props.onUpdateSuggests&&this.props.onUpdateSuggests(i,o),this.setState({suggests:i,activeSuggest:o},e)},K.prototype.updateActiveSuggest=function(t){void 0===t&&(t=[]);var e=this.state.activeSuggest;return e=e&&(t.filter(function(t){return e&&e.placeId===t.placeId&&e.isFixture===t.isFixture})[0]||null)},K.prototype.showSuggests=function(){this.searchSuggests(),this.setState({isSuggestsHidden:!1})},K.prototype.hideSuggests=function(){var t=this;this.props.onBlur&&this.props.onBlur(this.state.userInput),this.timer=window.setTimeout(function(){t.setState({activeSuggest:null,isSuggestsHidden:!0})},100)},K.prototype.activateSuggest=function(t){if(this.state.isSuggestsHidden)this.showSuggests();else{for(var e=this.state.suggests.length-1,s="next"===t,o=null,i=0,n=0;n<=e;n++)this.state.suggests[n]===this.state.activeSuggest&&(i=s?n+1:n-1);this.state.activeSuggest||(i=s?0:e),0<=i&&i<=e&&(o=this.state.suggests[i]),this.props.onActivateSuggest&&this.props.onActivateSuggest(o),this.setState({activeSuggest:o})}},K.prototype.selectSuggest=function(t){var e=t||{isFixture:!1,label:this.state.userInput,placeId:this.state.userInput};if(!t&&this.props.autoActivateFirstSuggest&&0<this.state.suggests.length&&(e=this.state.suggests[0]),this.setState({isSuggestsHidden:!0,userInput:"object"!=typeof e.label?e.label:e.description||""}),e.location)return this.setState({ignoreBlur:!1}),void(this.props.onSuggestSelect&&this.props.onSuggestSelect(e));this.geocodeSuggest(e)},K.prototype.geocodeSuggest=function(n){var t,r=this;this.geocoder&&(n.placeId&&!n.isFixture&&this.placesService?(t={placeId:n.placeId,sessionToken:this.sessionToken},this.props.placeDetailFields&&(t.fields=this.props.placeDetailFields,t.fields.unshift("geometry")),this.placesService.getDetails(t,function(t,e){var s,o,i;e===r.googleMaps.places.PlacesServiceStatus.OK&&(o=(s=t).geometry&&s.geometry.location,i=c(c({},n),{gmaps:s,location:{lat:o.lat(),lng:o.lng()}}),r.sessionToken=new google.maps.places.AutocompleteSessionToken,r.props.onSuggestSelect&&r.props.onSuggestSelect(i))})):(t={address:n.label,bounds:this.props.bounds,componentRestrictions:this.props.country?{country:this.props.country}:void 0,location:this.props.location},this.geocoder.geocode(t,function(t,e){var s,o,i;e===r.googleMaps.GeocoderStatus.OK&&(o=(s=t[0]).geometry&&s.geometry.location,i=c(c({},n),{gmaps:s,location:{lat:o.lat(),lng:o.lng()}}),r.props.onSuggestSelect&&r.props.onSuggestSelect(i))})))},K.prototype.render=function(){var e=this,t=M(this.props),s=n("geosuggest",this.props.className,{"geosuggest--loading":this.state.isLoading}),o=u.createElement(T,c({className:this.props.inputClassName,ref:function(t){return e.input=t},value:this.state.userInput,doNotSubmitOnEnter:!this.state.isSuggestsHidden,ignoreTab:this.props.ignoreTab,ignoreEnter:this.props.ignoreEnter,style:this.props.style&&this.props.style.input,onChange:this.onInputChange,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onKeyDown:this.props.onKeyDown,onKeyPress:this.props.onKeyPress,onNext:this.onNext,onPrev:this.onPrev,onSelect:this.onSelect,onEscape:this.hideSuggests,isSuggestsHidden:this.state.isSuggestsHidden,activeSuggest:this.state.activeSuggest,label:this.props.label,id:this.props.id,listId:this.listId},t)),i=u.createElement(F,{isHidden:this.state.isSuggestsHidden,style:this.props.style&&this.props.style.suggests,suggestItemStyle:this.props.style&&this.props.style.suggestItem,userInput:this.state.userInput,isHighlightMatch:Boolean(this.props.highlightMatch),suggestsClassName:this.props.suggestsClassName,suggestItemClassName:this.props.suggestItemClassName,suggests:this.state.suggests,hiddenClassName:this.props.suggestsHiddenClassName,suggestItemActiveClassName:this.props.suggestItemActiveClassName,activeSuggest:this.state.activeSuggest,onSuggestNoResults:this.onSuggestNoResults,onSuggestMouseDown:this.onSuggestMouseDown,onSuggestMouseOut:this.onSuggestMouseOut,onSuggestSelect:this.selectSuggest,renderSuggestItem:this.props.renderSuggestItem,listId:this.listId});return u.createElement("div",{className:s,id:this.props.id},u.createElement("div",{className:"geosuggest__input-wrapper"},o),u.createElement("div",{className:"geosuggest__suggests-wrapper"},i))},K.defaultProps=N,K}(React);
